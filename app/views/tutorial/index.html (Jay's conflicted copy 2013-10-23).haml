- if current_user.groups.length > 0

	.modal.fade#time(tabindex="-1")
		.modal-dialog
			.modal-content
				.modal-header
					%button.close(data-dismiss="modal" aria-hidden="true" type="button") &times;
					%h4.modal-title Switch Tutorial
				.modal-body
					= form_for :tutorial, :url => "/tutorial", :method => "get" do |f|
						.form-group
							%label Course
							= f.collection_select :course_id, Course.all(:order => "created_at DESC" ), :id, :name, { selected: @group ? @group.course.id : 0 }, { :class => "form-control" }
						.form-group
							%label Group
							= f.collection_select :group_id, Group.all(:order => :name ), :id, :select_name, { selected: @group ? @group.id : 0 }, { :class => "form-control" }
						.form-group
							%label Week
							= f.collection_select :week_id, @group.course.weeks(:order => :start), :id, :select_name, { selected: @week ? @week.id : 0 }, { :class => "form-control" }
				.modal-footer
					%button.btn.btn-default(data-dismiss="modal") Close
					- #%button.btn.btn-primary Switch

	.modal.fade#manage
		.modal-dialog
			.modal-content
				.modal-header
					%button.close(data-dismiss="modal" aria-hidden="true" type="button") &times;
					%h4.modal-title Manage Students
				.modal-body
					.row
						.col-md-12
							%h5 Find a student
							= form_tag({:action => "move", :method=>"post"},{:id=>"move"}) do |f|
								%input{:type=>"hidden", :name=>"group_id", :value=>@group.id}
								%input{:type=>"hidden", :name=>"week_id", :value=>@week.id}
								.form-group
									%input.form-control.input-sm#search(name="student_id")
								.form-group
									.radio
										%label
											%input(type="radio" name="mode" value="temp" checked=true)
											Move temporarily
									.radio
										%label
											%input(type="radio" name="mode" value="perm")
											Move permanently
									%button.disabled.move#moveperm.btn.btn-default.btn-sm.sort(type="submit") Move!

					.row
						.col-md-12
							%h5 Add a student
							= form_tag({ :action => "create_student", :method => "post" }, { :class => "form-horizontal" }) do
								%input{:type=>"hidden", :name=>"group_id", :value=>@group.id}
								%input{:type=>"hidden", :name=>"week_id", :value=>@week.id}
								.form-group
									%label.col-md-3.control-label Firstname
									.col-md-9
										%input.form-control.input-sm(type="text" name="firstname")
								.form-group
									%label.col-md-3.control-label Lastname
									.col-md-9
										%input.form-control.input-sm(type="text" name="lastname")
								.form-group
									%label.col-md-3.control-label MatrNr
									.col-md-9
										%input.form-control.input-sm(type="text" name="matrnr")
								.form-group
									%label.col-md-3.control-label Email
									.col-md-9
										%input.form-control.input-sm(type="text" name="email")

				.modal-footer
					%button.btn.btn-default(data-dismiss="modal") Close

	.row
		.col-md-12
			%h2 
				Tutorial
				.btn-group(style="margin-left:20px; margin-bottom: 7px")
					%button.btn.btn-default.enable-tooltip(data-toggle="modal" href="#time" title="Switch to different course, group or week.")
						%i.glyphicon.glyphicon-time 
						Switch
					%button.btn.btn-default.enable-tooltip(data-toggle="modal" href="#manage" title="Add or create a student.")
						%i.glyphicon.glyphicon-plus 
						Find/Add Student
					%button#sort.btn.btn-default.enable-tooltip(title="Sort.")
						%i.glyphicon.glyphicon-sort-by-alphabet 
						Sort
					%button#random.btn.btn-default.enable-tooltip(title="Select random student.")
						%i.glyphicon.glyphicon-random 
						Random
					%button#logout.btn.btn-default.enable-tooltop(href="destroy_user_session_path" title="Logout")
						%i.glyphicon.glyphicon-log-out
						Logout

	%table.table.table-striped.table-condensed
		- if false 
			%thead
				%tr
					%th Points
					%th Lastname
					%th Firstname
					%th Email

		%tbody
			- @students.each do |s|
				- a = Assessment.where(:student => s, :week => @week).first || Assessment.new(:value => -1, :user=>current_user, :student => s, :week => @week, :group => @group)
				%tr{ "data-othergroup" => (a.user != current_user && a.value >= 0) ? "1" : "0" }
					%td
						= form_for a, :method=>:post,:html => { :class => "form-inline" } do |f|
							= f.hidden_field :user_id
							= f.hidden_field :week_id
							= f.hidden_field :student_id
							= f.hidden_field :group_id
							.input-group.pull-left(style="width: 120px")
								%span.input-group-btn
									%button.btn.btn-default.point-adjust.btn-sm(type="button" data-value="-1") -
								= f.text_field :value, :class=>"form-control input-sm"
								%span.input-group-btn
									%button.btn.btn-default.point-adjust.btn-sm(type="button" data-value="+1") +

							- if a.user != current_user && a.value >= 0
								.pull-left(style="margin-left:10px")
									.div.enable-tooltip(title="Attended tutorial #{a.group.name} by #{a.user.firstname} #{a.user.lastname}")
										%i.glyphicon.glyphicon-plane
							- if a.user == current_user && s.groups.where(:course => @group.course).first.user != current_user
								.pull-left(style="margin-left:10px")
									.div.enable-tooltip(title="This student is temporarily in this group. His original group is #{s.groups.where(:course => @group.course).first.name} held by #{s.groups.where(:course => @group.course).first.user.name}")
										%i.glyphicon.glyphicon-pushpin

					%td= s.lastname
					%td= s.firstname
					%td= s.email


	:coffeescript
		window.tutorial(#{@group.id})
